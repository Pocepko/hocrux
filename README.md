[![codecov](https://codecov.io/gh/Pocepko/hocrux/branch/development/graph/badge.svg?token=G7BMEY30U1)](https://codecov.io/gh/Pocepko/hocrux)

# Почепко Илья Вячеславович, БО5-253

# Hocrux - Реализация схемы разделения секрета Шамира

## Описание проекта
Проект реализует утилиту командной строки `hocrux`, которая позволяет разделить файл на несколько частей по схеме Шамира. Схема Шамира — это криптографическая техника, которая позволяет разделить данные (секрет) на несколько частей, из которых только определённое количество частей требуется для восстановления исходного файла. Этот проект позволяет пользователям разбивать файл на зашифрованные части (команда `split`) и восстанавливать исходный файл из частей (команда `bind`).

## Реализуемый функционал
Основные функции утилиты `hocrux`:
1. **Разделение файла на несколько частей (`split`)**:
   - Пользователь указывает, сколько частей необходимо создать, и сколько частей потребуется для восстановления исходного файла.
   - Программа генерирует шифрованные части файла и сохраняет их в текущем каталоге.

2. **Восстановление исходного файла из частей (`bind`)**:
   - Программа собирает файл обратно, используя указанное количество частей.

## Архитектура
### Основные классы и функции
1. **Класс `ShamirSecretSharing`**:
   - Реализует основные методы для разделения и восстановления секретов по схеме Шамира.
   - **Методы:**
     - `split(secret: bytes, n_parts: int, threshold: int) -> List[Tuple[int, bytes]]`: Делит секрет на `n_parts`, из которых для восстановления потребуется не менее `threshold` частей. Возвращает список частей в формате `(индекс, зашифрованная часть)`.
     - `combine(parts: List[Tuple[int, bytes]]) -> bytes`: Принимает список частей и восстанавливает исходный секрет, если количество частей больше или равно `threshold`.

2. **Класс `FileHandler`**:
   - Обрабатывает операции чтения и записи файлов.
   - **Методы:**
     - `read_file(file_path: str) -> bytes`: Читает содержимое файла.
     - `write_shares(file_prefix: str, shares: List[Tuple[int, bytes]])`: Записывает части в отдельные файлы, используя `file_prefix` в качестве префикса для имён файлов.
     - `read_shares(file_prefix: str, required_count: int) -> List[Tuple[int, bytes]]`: Загружает необходимые части для восстановления исходного файла.

3. **Функции командной строки**:
   - **`split_command(file_path: str, n_parts: int, threshold: int)`**:
     - Команда для разбиения файла на `n_parts`, из которых для восстановления потребуется не менее `threshold`.
     - Читает содержимое файла, выполняет разделение с помощью класса `ShamirSecretSharing`, и сохраняет части.

   - **`bind_command(file_prefix: str, output_file: str, required_count: int)`**:
     - Команда для восстановления файла. Читает указанные части с помощью класса `FileHandler`, выполняет восстановление с помощью класса `ShamirSecretSharing`, и записывает восстановленный файл.

### Структура проекта
```plaintext
hocrux/
├── hocrux.py               # Главный файл приложения
├── shamir.py               # Логика работы с секретами Шамира
├── file_handler.py         # Функции для работы с файлами
└── README.md               # Документация
```

## Библиотеки
Для реализации проекта предполагается использование следующих библиотек:
   - `math` и `random` для вычислений и генерации случайных чисел. 
   - `argparse` для обработки аргументов командной строки.
   - `os` для работы с файловой системой.
   - **Опционально**: `numpy` или `gmpy2` для математических вычислений.

## Поддерживаемые версии Python
Проект будет поддерживать Python 3.7 и выше.


## Использование программы
Для запуска программы нужно в терминале выполнить команду `python3 hocrux <command> <path> [-n <parts>] <threshold>`:
   - `python3 hocrux split picture.png -n 5 3` - разделит файл `picture.png` на пять частей `picture1.png, ..., picture5.png`, так что его можно востановить по любым трём частям
   - `python3 hocrux.py bind picture 3` - восстанавливает исходный `picture.png` файл по трём частям название которых начинается на `picture`

